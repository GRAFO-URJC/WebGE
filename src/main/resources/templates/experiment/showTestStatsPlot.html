<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.w3.org/1999/xhtml"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/default}"
      lang="en">

<head>
    <title>Experiment testing area</title>
</head>

<!--
    Attribute th:field will replace attributes value, id and name in your input tag.
    Instead, use plain th:id, th:value and th:name without using th:field. Then you will get what you wanted.
-->

<body>
<div id="page" layout:fragment="content" message=${errorMessage}>
    <!-- Main -->
    <div class="container">
        <div id="forms" class="panel panel-default">
            <header class="panel-heading">
                <h2>Run details of <i><span th:text="${expDetails.getExperimentName()}"></span></i></h2>
            </header>

            <section class="panel-body">
                <div class="row form-group">
                    <div id="chartContainer" style="height: 360px; width: 100%;"></div>
                </div>

                <!-- Show Diagram Plot details -->
                <div class="row form-group text-center" style="margin-bottom: 0px;">
                    <div class="col-sm-6 col-md-6 col-lg-6">
                        <h4>
                            <label>Run name: </label>
                            <label th:id="experimentName" th:text="${expDetails.getExperimentName()}"/>
                        </h4>
                    </div>
                    <div class="col-sm-6 col-md-6 col-lg-6">
                        <h4>
                            <label>Run description: </label>
                            <label th:id="experimentDescription" th:text="${expDetails.getExperimentDescription()}"/>
                        </h4>
                    </div>
                </div>
                <div class="row form-group text-center" style="margin-bottom: 0px;">
                    <div class="col-sm-6 col-md-6 col-lg-6">
                        <h4>
                            <label>Run id: </label>
                            <label th:id="runId" th:text="${expDetails.getRunId()}"/>
                        </h4>
                    </div>
                    <div class="col-sm-6 col-md-6 col-lg-6">
                        <h4>
                            <label>Run status: </label>
                        </h4>
                    </div>
                </div>
                <div class="row form-group text-center" style="margin-bottom: 0px;">
                    <div class="col-sm-6 col-md-6 col-lg-6">
                        <h4>
                            <label>Best individual: </label>
                        </h4>
                    </div>
                    <div class="col-sm-6 col-md-6 col-lg-6">
                        <h4>
                            <label>Current generation: </label>
                        </h4>
                    </div>
                </div>
                <!-- END - Show Diagram Plot details -->
            </section>
        </div>

        <!-- END Main -->

    </div>

    <script th:inline="javascript">
        let yColumnDataPoints = [], modelColumnDataPoints = [];

        function reloadPlotD3() {
            let chart = new CanvasJS.Chart("chartContainer", {
                animationEnabled: true,
                backgroundColor: "transparent",
                colorSet: "greenShades",
                animationEnabled: true,
                exportEnabled: true,
                theme: "theme3",
                zoomEnabled: true,
                panEnabled: true,

                title: {
                    text: "Diagram data flow showing best individual"
                },
                data: [{
                    markerSize: 4,
                    color: "OrangeRed",
                    type: "line",
                    dataPoints: yColumnDataPoints,
                    toolTipContent: "Solution : <b>{y}</b> <br/> Index y column: <b>{x}</b>"
                }, {
                    markerSize: 4,
                    color: "OrangeRed",
                    type: "line",
                    dataPoints: modelColumnDataPoints,
                    toolTipContent: "Solution : <b>{y}</b> <br/> Index model : <b>{x}</b>"
                }],
                axisX: {
                    title: "Index",
                    labelAngle: -50,
                    lineThickness: 1.0,
                    tickThickness: 0.5,
                },
                axisY: {
                    title: "Solution",
                    lineThickness: 1,
                    tickThickness: 1,
                    gridThickness: 1,
                },
                toolTip: {
                    shared: true,
                    enabled: true,
                    animationEnabled: true,
                },
            });


            /*<![CDATA[*/
            let listYLine = [[${listYLine}]];
            let listFunctionResult = [[${listFunctionResult}]];
            /*]]>*/
            let dataLoaderCount = 0, yPoint;

            for (dataLoaderCount; dataLoaderCount < listYLine.length; dataLoaderCount++) {
                yPoint = listYLine[dataLoaderCount];
                yColumnDataPoints.push({x: dataLoaderCount, y: parseFloat(yPoint)});

                yPoint = listFunctionResult[dataLoaderCount];
                modelColumnDataPoints.push({x: dataLoaderCount, y: parseFloat(yPoint)});

            }
            chart.render();
        }

        $(document).ready(function () {
            reloadPlotD3();
        });

    </script>
</div>
</body>
</html>